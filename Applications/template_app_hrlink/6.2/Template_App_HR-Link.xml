<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.2</version>
    <date>2025-05-12T08:34:26Z</date>
    <template_groups>
        <template_group>
            <uuid>7df96b18c230490a9a0a9e2307226338</uuid>
            <name>Templates</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>6956c2e5a1cc4d16bc7b60c2a747c4e6</uuid>
            <template>Template_App_HR-Link</template>
            <name>Template_App_HR-Link</name>
            <description>Information and plug-in are available here: https://github.com/VAGurko/zabbix_template_hrlink

You can report problems here: https://github.com/VAGurko/zabbix_template_hrlink/issues

The procedure for making changes is described here: https://github.com/VAGurko/zabbix_template_hrlink/wiki/Порядок-внесения-изменений-в-шаблон</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>f5101305297f4bc991ebad626c52e847</uuid>
                    <name>Ping web-service HR-Link</name>
                    <type>HTTP_AGENT</type>
                    <key>pingwebhrlink</key>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(.*)&lt;title&gt;(.*)(&lt;/title&gt;)</parameter>
                                <parameter>\2</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>5s</timeout>
                    <url>https://{$HRLINK.SERVICE.URL}</url>
                    <tags>
                        <tag>
                            <tag>HR-Link</tag>
                            <value>health</value>
                        </tag>
                        <tag>
                            <tag>service</tag>
                            <value>hrlink</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>4273c47ffb52449aa5ede992727a128d</uuid>
                            <expression>nodata(/Template_App_HR-Link/pingwebhrlink,5m)=1</expression>
                            <name>Portal HR-Link unavailable</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>service</tag>
                                    <value>hrlink</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>2039db4edbea40bd8e21f69c127f24c7</uuid>
                    <name>HR-Link Number of containers</name>
                    <type>HTTP_AGENT</type>
                    <key>test_http_value_hrlink_number_of_containers</key>
                    <history>1d</history>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..containers[*].length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>10s</timeout>
                    <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                    <follow_redirects>NO</follow_redirects>
                    <headers>
                        <header>
                            <name>header</name>
                            <value>content-type: application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>HR-Link</tag>
                            <value>health</value>
                        </tag>
                        <tag>
                            <tag>service</tag>
                            <value>hrlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e4ab07aeff7649eeb2cd94e53a366f5a</uuid>
                    <name>HR-Link Number of services</name>
                    <type>HTTP_AGENT</type>
                    <key>test_http_value_hrlink_number_of_services</key>
                    <history>1d</history>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..cloud[*].length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>10s</timeout>
                    <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                    <follow_redirects>NO</follow_redirects>
                    <headers>
                        <header>
                            <name>header</name>
                            <value>content-type: application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>HR-Link</tag>
                            <value>health</value>
                        </tag>
                        <tag>
                            <tag>service</tag>
                            <value>hrlink</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>d6372d5470064da9bead2ff30cc063fd</uuid>
                    <name>HR-Link Containers</name>
                    <type>HTTP_AGENT</type>
                    <key>http_value_hrlink_containers</key>
                    <delay>1h</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>188987c7d1514a44999abd7241979dde</uuid>
                            <name>HR-Link containers {#CONTAINERS_SERVICE} error message</name>
                            <type>HTTP_AGENT</type>
                            <key>http_value_hrlink_health_containers_error_message_[&quot;{#CONTAINERS_SERVICE}&quot;]</key>
                            <delay>10m</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>CHECK_NOT_SUPPORTED</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>0</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$..containers[?(@.service == '{#CONTAINERS_SERVICE}')].error_message</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[&quot;</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>&quot;]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>5m</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                            <headers>
                                <header>
                                    <name>header</name>
                                    <value>content-type: application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>HR-Link</tag>
                                    <value>health</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>hrlink</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>4ab002bffb3e468d8ff6e75933887f7f</uuid>
                            <name>HR-Link containers {#CONTAINERS_SERVICE} status</name>
                            <type>HTTP_AGENT</type>
                            <key>http_value_hrlink_health_containers_status_[&quot;{#CONTAINERS_SERVICE}&quot;]</key>
                            <history>30d</history>
                            <valuemap>
                                <name>Status of container</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>CHECK_NOT_SUPPORTED</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>1</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$..containers[?(@.service == '{#CONTAINERS_SERVICE}')].status</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                            <headers>
                                <header>
                                    <name>header</name>
                                    <value>content-type: application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>HR-Link</tag>
                                    <value>health</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>hrlink</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>2b9875caeb5a4766b51abdc795fcd162</uuid>
                                    <expression>sum(/Template_App_HR-Link/http_value_hrlink_health_containers_status_[&quot;{#CONTAINERS_SERVICE}&quot;],#5)&gt;=5</expression>
                                    <name>HR-Link containers {#CONTAINERS_SERVICE} stopped</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>service</tag>
                                            <value>hrlink</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>54977e5cfa344a96b6fcf4cef41c245f</uuid>
                            <name>HR-Link containers {#CONTAINERS_SERVICE} version</name>
                            <type>HTTP_AGENT</type>
                            <key>http_value_hrlink_health_containers_version_[&quot;{#CONTAINERS_SERVICE}&quot;]</key>
                            <delay>10m</delay>
                            <history>365d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$..containers[?(@.service == '{#CONTAINERS_SERVICE}')].version</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[&quot;</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>&quot;]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                            <headers>
                                <header>
                                    <name>header</name>
                                    <value>content-type: application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>HR-Link</tag>
                                    <value>health</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>hrlink</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>f130a6cad53b439aac6a00e381e8ab05</uuid>
                                    <expression>last(/Template_App_HR-Link/http_value_hrlink_health_containers_version_[&quot;{#CONTAINERS_SERVICE}&quot;],#1)&gt;0 and last(/Template_App_HR-Link/http_value_hrlink_health_containers_version_[&quot;{#CONTAINERS_SERVICE}&quot;]) &lt;&gt; last(/Template_App_HR-Link/http_value_hrlink_health_containers_version_[&quot;{#CONTAINERS_SERVICE}&quot;],#1)</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Template_App_HR-Link/http_value_hrlink_health_containers_version_[&quot;{#CONTAINERS_SERVICE}&quot;]) = last(/Template_App_HR-Link/http_value_hrlink_health_containers_version_[&quot;{#CONTAINERS_SERVICE}&quot;],#1)</recovery_expression>
                                    <name>HR-Link containers {#CONTAINERS_SERVICE} version changed</name>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>service</tag>
                                            <value>hrlink</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <timeout>10s</timeout>
                    <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                    <headers>
                        <header>
                            <name>header</name>
                            <value>content-type: application/json</value>
                        </header>
                    </headers>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#CONTAINERS_SERVICE}</lld_macro>
                            <path>$.service</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..containers[*]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>2d6906c7cedf491fbf886fe7cb879bf6</uuid>
                    <name>HR-Link Service</name>
                    <type>HTTP_AGENT</type>
                    <key>http_value_hrlink_service</key>
                    <delay>1h</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>d109eff3486345279c4db98ca27ef0ed</uuid>
                            <name>HR-Link service {#SERVICE_NAME} status</name>
                            <type>HTTP_AGENT</type>
                            <key>http_value_hrlink_health_service_status_[&quot;{#SERVICE_NAME}&quot;]</key>
                            <history>30d</history>
                            <valuemap>
                                <name>Status of service</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>CHECK_NOT_SUPPORTED</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>1</error_handler_params>
                                </step>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$..cloud[?(@.service == '{#SERVICE_NAME}')].status</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                            <headers>
                                <header>
                                    <name>header</name>
                                    <value>content-type: application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>HR-Link</tag>
                                    <value>health</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>hrlink</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>785442ac206d40a7bdd051717ee026e6</uuid>
                                    <expression>sum(/Template_App_HR-Link/http_value_hrlink_health_service_status_[&quot;{#SERVICE_NAME}&quot;],#5)&gt;=5</expression>
                                    <name>HR-Link service {#SERVICE_NAME} stopped</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>service</tag>
                                            <value>hrlink</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>89cb234f96e241f5b62104aedd625982</uuid>
                            <name>HR-Link service {#SERVICE_NAME} version</name>
                            <type>HTTP_AGENT</type>
                            <key>http_value_hrlink_health_service_[&quot;{#SERVICE_NAME}&quot;]</key>
                            <delay>10m</delay>
                            <history>365d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$..cloud[?(@.service == '{#SERVICE_NAME}')].version</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[&quot;</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>&quot;]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                            <headers>
                                <header>
                                    <name>header</name>
                                    <value>content-type: application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>HR-Link</tag>
                                    <value>health</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>hrlink</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>9af9695ec9734113935cc7417983a807</uuid>
                                    <expression>last(/Template_App_HR-Link/http_value_hrlink_health_service_[&quot;{#SERVICE_NAME}&quot;],#1)&gt;0 and last(/Template_App_HR-Link/http_value_hrlink_health_service_[&quot;{#SERVICE_NAME}&quot;]) &lt;&gt; last(/Template_App_HR-Link/http_value_hrlink_health_service_[&quot;{#SERVICE_NAME}&quot;],#1)</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Template_App_HR-Link/http_value_hrlink_health_service_[&quot;{#SERVICE_NAME}&quot;]) = last(/Template_App_HR-Link/http_value_hrlink_health_service_[&quot;{#SERVICE_NAME}&quot;],#1)</recovery_expression>
                                    <name>HR-Link service {#SERVICE_NAME} version changed</name>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>service</tag>
                                            <value>hrlink</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <timeout>10s</timeout>
                    <url>https://{$HRLINK.SERVICE.URL}/api/v1/health</url>
                    <headers>
                        <header>
                            <name>header</name>
                            <value>content-type: application/json</value>
                        </header>
                    </headers>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#SERVICE_NAME}</lld_macro>
                            <path>$.service</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#SERVICE_STATUS}</lld_macro>
                            <path>$.status</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#SERVICE_VER}</lld_macro>
                            <path>$.version</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..cloud[*]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$HRLINK.SERVICE.URL}</macro>
                    <value>hrlink.domain.com</value>
                    <description>URL HR-Link portal for monitoring</description>
                </macro>
            </macros>
            <valuemaps>
                <valuemap>
                    <uuid>0dbac93ec9f04d49a84d3b9320da3b5f</uuid>
                    <name>Status of container</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Running</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Stopping</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>39184b6240fe44528afa7bef70cce07c</uuid>
                    <name>Status of service</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Up</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Down</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
